import{I as e,V as a,U as l,S as o,d as t,h as u,o as d,e as r,j as s,w as n,B as p,F as c,az as i,aD as m,aE as _,A as v,P as y,f,L as V,g as k,c as g,t as D,aw as E,k as A,av as w,aF as x,aG as h,ay as U,aH as P,aI as b}from"../.pnpm/.pnpm.acc2b6ee.js";import{b as T,_ as C}from"../../assets/index.23e8f858.js";const F={GET_DATA_IF_SUCCEED:"数据请求成功",EXPORT_DATA_IF_SUCCEED:"导出数据成功",GET_DATA_IF_FAILED:"获取列表数据失败",EXPORT_DATA_IF_FAILED:"导出数据失败"},I={message:F};function $(e,a){o({message:e,...a,type:"success"})}function z(e,a){o({message:e,...a,type:"error"})}const G=t({__name:"addTable",emits:["comfirmAdd"],setup(e,{emit:a}){const{proxy:l}=y(),o=u({name:"",stockPrice:0,stockPlace:"",price:0,repository:0,type:"",productDate:""}),t=async()=>{const[e,t]=await l.$api.goods.insertGoods(o);!e&&t&&a("comfirmAdd")};return(e,a)=>{const l=i,u=m,y=_,f=v;return d(),r(c,null,[s(y,{ref:"form",model:o},{default:n((()=>[s(u,{label:"名称"},{default:n((()=>[s(l,{modelValue:o.name,"onUpdate:modelValue":a[0]||(a[0]=e=>o.name=e),placeholder:""},null,8,["modelValue"])])),_:1}),s(u,{label:"进货价"},{default:n((()=>[s(l,{modelValue:o.stockPrice,"onUpdate:modelValue":a[1]||(a[1]=e=>o.stockPrice=e),placeholder:""},null,8,["modelValue"])])),_:1}),s(u,{label:"进货地"},{default:n((()=>[s(l,{modelValue:o.stockPlace,"onUpdate:modelValue":a[2]||(a[2]=e=>o.stockPlace=e),placeholder:""},null,8,["modelValue"])])),_:1}),s(u,{label:"售价"},{default:n((()=>[s(l,{modelValue:o.price,"onUpdate:modelValue":a[3]||(a[3]=e=>o.price=e),placeholder:""},null,8,["modelValue"])])),_:1}),s(u,{label:"库存量"},{default:n((()=>[s(l,{modelValue:o.repository,"onUpdate:modelValue":a[4]||(a[4]=e=>o.repository=e),placeholder:""},null,8,["modelValue"])])),_:1}),s(u,{label:"商品品类"},{default:n((()=>[s(l,{modelValue:o.type,"onUpdate:modelValue":a[5]||(a[5]=e=>o.type=e),placeholder:""},null,8,["modelValue"])])),_:1}),s(u,{label:"生产日期"},{default:n((()=>[s(l,{modelValue:o.productDate,"onUpdate:modelValue":a[6]||(a[6]=e=>o.productDate=e),placeholder:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),s(f,{onClick:t},{default:n((()=>[p("点击提交")])),_:1})],64)}}}),S={class:"inputBox"},R={class:"searchBox"},L={key:1},q={key:1},O={key:1},j={key:1},X={key:1},B={key:1},H={key:1},K=C(t({__name:"superTable",setup(o){const{proxy:t}=y(),u={message:{GET_DATA_IF_SUCCEED:"商品数据请求成功",GET_DATA_IF_FAILED:"商品数据请求失败"}},{list:m,loading:_,currPage:C,pageSize:K,total:J,loadData:M}=function(o,t=I,u,d){const{immediate:r=!0,requestSuccess:s,exportSuccess:n,exportError:p,requestError:c,preRequest:i,message:m=F}=t,{GET_DATA_IF_SUCCEED:_,GET_DATA_IF_FAILED:v,EXPORT_DATA_IF_SUCCEED:y,EXPORT_DATA_IF_FAILED:f}=m,V=e(!1),k=e(1),g=e(0),D=e(10),E=e([]);a([k,D],(()=>{A(k.value,D.value)})),l((()=>{r&&A(k.value)}));const A=async(e=k.value,a=D.value)=>{let l={curr:e,pageSize:a,total:g.value};V.value=!0;const[t,d]=await o(l,null==u?void 0:u.value),{data:r,total:n}=d;E.value=r,!t&&d?(g.value=n,_&&$(_),s&&s()):(v&&z(v),c&&c()),V.value=!1};return{loading:V,currPage:k,total:g,list:E,filterOption:u,reload:()=>{A()},reset:()=>{if(!u)return;const e=Reflect.ownKeys(u.value);u.value={},e.forEach((e=>{Reflect.set(u.value,e,void 0)})),A()},filter:()=>{A()},pageSize:D,exportFile:async()=>{if(!d)throw new Error("当前没有提供exportRequestFn函数");if("function"!=typeof d)throw new Error("exportRequestFn必须是一个函数");try{const{data:{link:e}}=await d(null==u?void 0:u.value);window.open(e),y&&$(y),n&&n()}catch(e){f&&z(f),p&&p()}},loadData:A}}(t.$api.goods.getGoods,u),N=e(!1),Q=()=>{N.value=!0},W=()=>{N.value=!1,M()},Y=e(""),Z=()=>{},ee=e({name:"",stockPrice:0,stockPlace:"",price:0,repository:0,type:"",productDate:""}),ae=e(-1);return(e,a)=>{const l=i,o=T,u=v,y=h,F=U,I=P,$=b;return d(),r(c,null,[f("div",S,[f("div",R,[s(l,{modelValue:Y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Y.value=e),placeholder:"",clearable:""},null,8,["modelValue"]),s(u,{type:""},{default:n((()=>[s(o,{onClick:Z,name:"search"})])),_:1})]),s(u,{type:"primary",onClick:Q},{default:n((()=>[p("新增")])),_:1})]),V((d(),g(k(w),{data:k(m),stripe:"",border:"","cell-style":{textAlign:"center"},"header-cell-style":{"text-align":"center"}},{default:n((()=>[s(k(E),{label:"商品名称",prop:"name"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value.name=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",L,D(e.row.name),1))])),_:1}),s(k(E),{label:"售价",prop:"price"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.price,"onUpdate:modelValue":a[2]||(a[2]=e=>ee.value.price=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",q,D(e.row.price),1))])),_:1}),s(k(E),{label:"生产日期",prop:"productDate"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.productDate,"onUpdate:modelValue":a[3]||(a[3]=e=>ee.value.productDate=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",O,D(e.row.productDate),1))])),_:1}),s(k(E),{label:"库存量",prop:"repository"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.repository,"onUpdate:modelValue":a[4]||(a[4]=e=>ee.value.repository=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",j,D(e.row.repository),1))])),_:1}),s(k(E),{label:"进货地",prop:"stockPlace"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.stockPlace,"onUpdate:modelValue":a[5]||(a[5]=e=>ee.value.stockPlace=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",X,D(e.row.stockPlace),1))])),_:1}),s(k(E),{label:"进货价",prop:"stockPrice"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.stockPrice,"onUpdate:modelValue":a[6]||(a[6]=e=>ee.value.stockPrice=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",B,D(e.row.stockPrice),1))])),_:1}),s(k(E),{label:"品类",prop:"type"},{default:n((e=>[ae.value===e.$index?(d(),g(l,{key:0,modelValue:ee.value.type,"onUpdate:modelValue":a[7]||(a[7]=e=>ee.value.type=e),placeholder:""},null,8,["modelValue"])):(d(),r("span",H,D(e.row.type),1))])),_:1}),s(k(E),{"min-width":"110px",label:"操作"},{default:n((e=>[ae.value!==e.$index?(d(),g(u,{key:0,type:"primary",size:"small",onClick:a=>(e=>{ae.value=e.$index,ee.value=e.row})(e)},{default:n((()=>[p("编辑")])),_:2},1032,["onClick"])):A("",!0),ae.value===e.$index?(d(),g(y,{key:1,title:"确认修改此条数据吗",onConfirm:a=>(async e=>{ae.value=-1;const[a,l]=await t.$api.goods.updatedGoods({id:e,data:ee.value});!a&&l&&(t.$message.success("编辑成功！"),M())})(e.row.id)},{reference:n((()=>[s(u,{type:"primary",size:"small"},{default:n((()=>[p("确认")])),_:1})])),_:2},1032,["onConfirm"])):A("",!0),s(y,{title:"确定删除该条数据吗",onConfirm:a=>(async e=>{const[a,l]=await t.$api.goods.deletedGoods({id:e});!a&&l&&(t.$message.success("删除成功！"),J.value%K.value==1&&(C.value-=1),M())})(e.row.id)},{reference:n((()=>[s(u,{type:"danger",size:"small"},{default:n((()=>[p("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[$,k(_)]]),s(F,{modelValue:N.value,"onUpdate:modelValue":a[8]||(a[8]=e=>N.value=e),title:"添加新商品"},{default:n((()=>[s(G,{onComfirmAdd:W})])),_:1},8,["modelValue"]),s(I,{total:k(J),"page-sizes":[5,10,15,20],"current-page":k(C),"onUpdate:current-page":a[9]||(a[9]=e=>x(C)?C.value=e:null),"page-size":k(K),"onUpdate:page-size":a[10]||(a[10]=e=>x(K)?K.value=e:null),layout:"total,sizes, prev, pager, next, jumper"},null,8,["total","current-page","page-size"])],64)}}}),[["__scopeId","data-v-8847bd00"]]);export{K as default};
